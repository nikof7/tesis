<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Fase lunar | Tesis</title>
  <meta name="description" content="Donde se irá desarrollando la tésis." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Fase lunar | Tesis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Donde se irá desarrollando la tésis." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Fase lunar | Tesis" />
  
  <meta name="twitter:description" content="Donde se irá desarrollando la tésis." />
  

<meta name="author" content="Nicolás Fernández-Sauleda" />


<meta name="date" content="2024-11-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="categorías-de-nicho-temporal.html"/>
<link rel="next" href="tasa-de-registro-vacunos-y-perros-domésticos.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Tesis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Acerca de</a></li>
<li class="chapter" data-level="2" data-path="carga-de-datos.html"><a href="carga-de-datos.html"><i class="fa fa-check"></i><b>2</b> Carga de Datos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="carga-de-datos.html"><a href="carga-de-datos.html#observaciones-en-cámaras-trampa"><i class="fa fa-check"></i><b>2.1</b> Observaciones en Cámaras Trampa</a></li>
<li class="chapter" data-level="2.2" data-path="carga-de-datos.html"><a href="carga-de-datos.html#preparación-de-datos"><i class="fa fa-check"></i><b>2.2</b> Preparación de Datos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exploración-inicial-de-los-datos.html"><a href="exploración-inicial-de-los-datos.html"><i class="fa fa-check"></i><b>3</b> Exploración inicial de los datos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="exploración-inicial-de-los-datos.html"><a href="exploración-inicial-de-los-datos.html#cantidad-de-registros-independientes-por-especie-y-área"><i class="fa fa-check"></i><b>3.1</b> Cantidad de registros independientes por especie y área</a></li>
<li class="chapter" data-level="3.2" data-path="exploración-inicial-de-los-datos.html"><a href="exploración-inicial-de-los-datos.html#sistemas-y-cámaras"><i class="fa fa-check"></i><b>3.2</b> Sistemas y cámaras</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hora-solar.html"><a href="hora-solar.html"><i class="fa fa-check"></i><b>4</b> Hora solar</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hora-solar.html"><a href="hora-solar.html#paquete-circular"><i class="fa fa-check"></i><b>4.1</b> Paquete circular</a></li>
<li class="chapter" data-level="4.2" data-path="hora-solar.html"><a href="hora-solar.html#paquete-activity"><i class="fa fa-check"></i><b>4.2</b> Paquete activity</a></li>
<li class="chapter" data-level="4.3" data-path="hora-solar.html"><a href="hora-solar.html#comparación-de-resultados"><i class="fa fa-check"></i><b>4.3</b> Comparación de resultados</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="hora-solar.html"><a href="hora-solar.html#conclusión"><i class="fa fa-check"></i><b>4.3.1</b> Conclusión</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="categorías-de-nicho-temporal.html"><a href="categorías-de-nicho-temporal.html"><i class="fa fa-check"></i><b>5</b> Categorías de nicho temporal</a>
<ul>
<li class="chapter" data-level="5.1" data-path="categorías-de-nicho-temporal.html"><a href="categorías-de-nicho-temporal.html#noche-día-y-crepúsculo"><i class="fa fa-check"></i><b>5.1</b> Noche, Día y Crepúsculo</a></li>
<li class="chapter" data-level="5.2" data-path="categorías-de-nicho-temporal.html"><a href="categorías-de-nicho-temporal.html#diurno-y-nocturno"><i class="fa fa-check"></i><b>5.2</b> Diurno y nocturno</a></li>
<li class="chapter" data-level="5.3" data-path="categorías-de-nicho-temporal.html"><a href="categorías-de-nicho-temporal.html#conclusión-1"><i class="fa fa-check"></i><b>5.3</b> Conclusión</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fase-lunar.html"><a href="fase-lunar.html"><i class="fa fa-check"></i><b>6</b> Fase lunar</a>
<ul>
<li class="chapter" data-level="6.1" data-path="fase-lunar.html"><a href="fase-lunar.html#preparación-de-datos-1"><i class="fa fa-check"></i><b>6.1</b> Preparación de datos</a></li>
<li class="chapter" data-level="6.2" data-path="fase-lunar.html"><a href="fase-lunar.html#iluminación-de-la-luna"><i class="fa fa-check"></i><b>6.2</b> Iluminación de la Luna</a></li>
<li class="chapter" data-level="6.3" data-path="fase-lunar.html"><a href="fase-lunar.html#overlap-utilizando-fase-lunar"><i class="fa fa-check"></i><b>6.3</b> Overlap utilizando fase lunar</a></li>
<li class="chapter" data-level="6.4" data-path="fase-lunar.html"><a href="fase-lunar.html#kernels-de-superposición-para-pares-de-especies"><i class="fa fa-check"></i><b>6.4</b> Kernels de Superposición para Pares de Especies</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tasa-de-registro-vacunos-y-perros-domésticos.html"><a href="tasa-de-registro-vacunos-y-perros-domésticos.html"><i class="fa fa-check"></i><b>7</b> Tasa de registro vacunos y perros domésticos</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="tasa-de-registro-vacunos-y-perros-domésticos.html"><a href="tasa-de-registro-vacunos-y-perros-domésticos.html#nivel-sistema"><i class="fa fa-check"></i><b>7.0.1</b> Nivel sistema</a></li>
<li class="chapter" data-level="7.0.2" data-path="tasa-de-registro-vacunos-y-perros-domésticos.html"><a href="tasa-de-registro-vacunos-y-perros-domésticos.html#nivel-camara"><i class="fa fa-check"></i><b>7.0.2</b> Nivel camara</a></li>
<li class="chapter" data-level="7.0.3" data-path="tasa-de-registro-vacunos-y-perros-domésticos.html"><a href="tasa-de-registro-vacunos-y-perros-domésticos.html#tabla-única"><i class="fa fa-check"></i><b>7.0.3</b> Tabla única</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="coberturas.html"><a href="coberturas.html"><i class="fa fa-check"></i><b>8</b> Coberturas</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="coberturas.html"><a href="coberturas.html#clases-de-cobertura-simples"><i class="fa fa-check"></i><b>8.0.1</b> Clases de Cobertura Simples</a></li>
<li class="chapter" data-level="8.0.2" data-path="coberturas.html"><a href="coberturas.html#clases-de-cobertura-agregadas"><i class="fa fa-check"></i><b>8.0.2</b> Clases de Cobertura Agregadas</a></li>
<li class="chapter" data-level="8.0.3" data-path="coberturas.html"><a href="coberturas.html#procesamiento-de-datos"><i class="fa fa-check"></i><b>8.0.3</b> Procesamiento de datos</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="variables-climáticas.html"><a href="variables-climáticas.html"><i class="fa fa-check"></i><b>9</b> Variables climáticas</a>
<ul>
<li class="chapter" data-level="9.1" data-path="variables-climáticas.html"><a href="variables-climáticas.html#procesamiento-de-datos-1"><i class="fa fa-check"></i><b>9.1</b> Procesamiento de datos</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="variables-climáticas.html"><a href="variables-climáticas.html#temperatura"><i class="fa fa-check"></i><b>9.1.1</b> Temperatura</a></li>
<li class="chapter" data-level="9.1.2" data-path="variables-climáticas.html"><a href="variables-climáticas.html#precipitaciones"><i class="fa fa-check"></i><b>9.1.2</b> Precipitaciones</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="variables-climáticas.html"><a href="variables-climáticas.html#alternativa-open-meteo"><i class="fa fa-check"></i><b>9.2</b> Alternativa open-meteo</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="kernels-de-actividad.html"><a href="kernels-de-actividad.html"><i class="fa fa-check"></i><b>10</b> Kernels de actividad</a>
<ul>
<li class="chapter" data-level="10.1" data-path="kernels-de-actividad.html"><a href="kernels-de-actividad.html#exploración-de-estresores-a-nivel-de-cámara-y-sistema"><i class="fa fa-check"></i><b>10.1</b> Exploración de estresores a nivel de cámara y sistema</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="kernels-de-actividad.html"><a href="kernels-de-actividad.html#conclusión-2"><i class="fa fa-check"></i><b>10.1.1</b> Conclusión</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="kernels-de-actividad.html"><a href="kernels-de-actividad.html#densidades-de-kernel"><i class="fa fa-check"></i><b>10.2</b> Densidades de kernel</a></li>
<li class="chapter" data-level="10.3" data-path="kernels-de-actividad.html"><a href="kernels-de-actividad.html#diseño-y-generación-de-gráficos"><i class="fa fa-check"></i><b>10.3</b> Diseño y generación de gráficos</a></li>
<li class="chapter" data-level="10.4" data-path="kernels-de-actividad.html"><a href="kernels-de-actividad.html#calculos-de-overlap"><i class="fa fa-check"></i><b>10.4</b> Calculos de overlap</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="exploración-general-de-modelos.html"><a href="exploración-general-de-modelos.html"><i class="fa fa-check"></i><b>11</b> Exploración general de modelos</a>
<ul>
<li class="chapter" data-level="11.1" data-path="exploración-general-de-modelos.html"><a href="exploración-general-de-modelos.html#modelo-lineal-simple"><i class="fa fa-check"></i><b>11.1</b> Modelo lineal simple</a></li>
<li class="chapter" data-level="11.2" data-path="exploración-general-de-modelos.html"><a href="exploración-general-de-modelos.html#incluir-interacciones"><i class="fa fa-check"></i><b>11.2</b> Incluir interacciones</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="modelos-para-jenni.html"><a href="modelos-para-jenni.html"><i class="fa fa-check"></i><b>12</b> Modelos para Jenni</a>
<ul>
<li class="chapter" data-level="12.1" data-path="modelos-para-jenni.html"><a href="modelos-para-jenni.html#preparación-de-datos-2"><i class="fa fa-check"></i><b>12.1</b> Preparación de datos</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="modelos-para-jenni.html"><a href="modelos-para-jenni.html#tasa-de-registro"><i class="fa fa-check"></i><b>12.1.1</b> Tasa de registro</a></li>
<li class="chapter" data-level="12.1.2" data-path="modelos-para-jenni.html"><a href="modelos-para-jenni.html#estado-de-los-datos"><i class="fa fa-check"></i><b>12.1.2</b> Estado de los datos</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="modelos-para-jenni.html"><a href="modelos-para-jenni.html#modelo-generalidades"><i class="fa fa-check"></i><b>12.2</b> Modelo generalidades</a></li>
<li class="chapter" data-level="12.3" data-path="modelos-para-jenni.html"><a href="modelos-para-jenni.html#modelo-utilizando-brms"><i class="fa fa-check"></i><b>12.3</b> Modelo utilizando brms</a></li>
<li class="chapter" data-level="12.4" data-path="modelos-para-jenni.html"><a href="modelos-para-jenni.html#modelo-con-interacciones"><i class="fa fa-check"></i><b>12.4</b> Modelo con interacciones</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="anexo-1.html"><a href="anexo-1.html"><i class="fa fa-check"></i><b>13</b> Anexo 1</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/nikof7/tesis" target="blank">Nicolás Fernández-Sauleda</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tesis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fase-lunar" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Fase lunar<a href="fase-lunar.html#fase-lunar" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Se necesita tener la fase lunar de cada registro, quizás lo óptimo sería analizar solo los registros nocturnos, pero en esta oportunidad agregaré este dato a todos los registros. Para obtener este dato se utilizará el paquete suncalc.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="fase-lunar.html#cb25-1" tabindex="-1"></a><span class="fu">library</span>(suncalc)</span></code></pre></div>
<p>Cuando se aplica la función <code>getMoonIllumination</code> se obtienen los siguientes datos.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="fase-lunar.html#cb26-1" tabindex="-1"></a><span class="fu">getMoonIllumination</span>(<span class="at">date =</span> <span class="fu">Sys.Date</span>())</span></code></pre></div>
<pre><code>##         date  fraction    phase     angle
## 1 2024-11-11 0.7116466 0.319563 -1.978832</code></pre>
<p>Donde:</p>
<ul>
<li>0: Luna Nueva</li>
<li>Luna Creciente</li>
<li>0.25: Cuarto Creciente</li>
<li>Luna Gibosa Creciente</li>
<li>0.5: Luna Llena</li>
<li>Luna Gibosa Menguante</li>
<li>0.75: Cuarto Menguante</li>
<li>Luna Menguante</li>
</ul>
<p align="center">
<img src="images/fasesluna.png" alt="isolated" width="500"/>
</p>
<div id="preparación-de-datos-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Preparación de datos<a href="fase-lunar.html#preparación-de-datos-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Me parece que el análisis que incluye las fases lunares deben hacerse solo con los registros nocturnos y crepusculares. Por lo que primero se establecen que registros caen dentro de estas categorías. Siendo <span class="math inline">\(\frac{\pi}{2}\)</span> el amanecer y <span class="math inline">\(\frac{3\pi}{2}\)</span> el atardecer.</p>
<p>(Actualización) Debe hacerse con todos los registros, no solo los nocturnos. Igualmente dejo la columna “nocturnal” porque es de interés.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="fase-lunar.html#cb28-1" tabindex="-1"></a>data_moon_illumination <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="fase-lunar.html#cb28-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nocturnal =</span> <span class="fu">ifelse</span>(solar <span class="sc">&lt;</span> pi<span class="sc">/</span><span class="dv">2</span> <span class="sc">|</span> solar <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">*</span> pi<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<p>Con el código de arriba se puede clasificar fácilmente entre registros nocturnos y diurnos. Utilizando como ejemplo a <em>L. gymnocercus</em> y se grafican los registros nocturnos se tiene:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="fase-lunar.html#cb29-1" tabindex="-1"></a>circular_data <span class="ot">&lt;-</span> <span class="fu">circular</span>(data_moon_illumination <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sp <span class="sc">==</span> <span class="st">&quot;Lgym&quot;</span> <span class="sc">&amp;</span> nocturnal <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(solar),</span>
<span id="cb29-2"><a href="fase-lunar.html#cb29-2" tabindex="-1"></a>                <span class="at">rotation =</span> <span class="st">&quot;counter&quot;</span>,</span>
<span id="cb29-3"><a href="fase-lunar.html#cb29-3" tabindex="-1"></a>                <span class="at">template =</span> <span class="st">&quot;clock24&quot;</span>)</span>
<span id="cb29-4"><a href="fase-lunar.html#cb29-4" tabindex="-1"></a><span class="co"># 00, 12, 18, 6</span></span>
<span id="cb29-5"><a href="fase-lunar.html#cb29-5" tabindex="-1"></a><span class="fu">plot</span>(circular_data,</span>
<span id="cb29-6"><a href="fase-lunar.html#cb29-6" tabindex="-1"></a>     <span class="at">stack =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-7"><a href="fase-lunar.html#cb29-7" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#698B22&quot;</span>,</span>
<span id="cb29-8"><a href="fase-lunar.html#cb29-8" tabindex="-1"></a>     <span class="at">start.sep=</span><span class="fl">0.05</span>,</span>
<span id="cb29-9"><a href="fase-lunar.html#cb29-9" tabindex="-1"></a>     <span class="at">sep =</span> <span class="fl">0.01</span>,</span>
<span id="cb29-10"><a href="fase-lunar.html#cb29-10" tabindex="-1"></a>     <span class="at">bins =</span> <span class="dv">128</span>,</span>
<span id="cb29-11"><a href="fase-lunar.html#cb29-11" tabindex="-1"></a>     <span class="at">ticks =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-12"><a href="fase-lunar.html#cb29-12" tabindex="-1"></a>     <span class="at">tol =</span> <span class="fl">0.2</span>,</span>
<span id="cb29-13"><a href="fase-lunar.html#cb29-13" tabindex="-1"></a>     <span class="at">cex =</span> .<span class="dv">7</span>,</span>
<span id="cb29-14"><a href="fase-lunar.html#cb29-14" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Registros nocturnos de L. gymnocercus en horario solar&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-78-1.png" width="100%" /></p>
</div>
<div id="iluminación-de-la-luna" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Iluminación de la Luna<a href="fase-lunar.html#iluminación-de-la-luna" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para todos los registros se obtiene el valor de la fracción iluminada de la luna, donde:</p>
<ul>
<li>0 equivale a luna nueva</li>
<li>1 a luna llena.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="fase-lunar.html#cb30-1" tabindex="-1"></a>data_moon_illumination <span class="ot">&lt;-</span> data_moon_illumination <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="fase-lunar.html#cb30-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">moon_ilumination =</span> <span class="fu">getMoonIllumination</span>(<span class="at">date =</span> <span class="fu">as_date</span>(datetime))<span class="sc">$</span>fraction)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["site"],"name":[1],"type":["chr"],"align":["left"]},{"label":["camera"],"name":[2],"type":["chr"],"align":["left"]},{"label":["lat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lon"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["datetime"],"name":[5],"type":["dttm"],"align":["right"]},{"label":["sp"],"name":[6],"type":["chr"],"align":["left"]},{"label":["solar"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["clock"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["nocturnal"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["moon_ilumination"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"SM","2":"SM06_3","3":"-33.72585","4":"-53.58035","5":"2023-02-07 07:56:22","6":"Btau","7":"2.135101","8":"2.078542","9":"0","10":"0.9849170","_rn_":"1"},{"1":"SM","2":"SM06_2","3":"-33.72585","4":"-53.58035","5":"2023-02-06 15:05:08","6":"Btau","7":"3.810810","8":"3.949389","9":"0","10":"0.9976228","_rn_":"2"},{"1":"SM","2":"SM01_1","3":"-33.72585","4":"-53.58035","5":"2023-02-06 12:13:33","6":"Btau","7":"3.141334","8":"3.200716","9":"0","10":"0.9976228","_rn_":"3"},{"1":"SM","2":"SM01_1","3":"-33.72585","4":"-53.58035","5":"2023-02-06 08:07:45","6":"Btau","7":"2.182284","8":"2.128211","9":"0","10":"0.9976228","_rn_":"4"},{"1":"SM","2":"SM01_1","3":"-33.72585","4":"-53.58035","5":"2023-02-05 21:59:46","6":"Btau","7":"5.578795","8":"5.758568","9":"1","10":"0.9929086","_rn_":"5"},{"1":"SM","2":"SM01_1","3":"-33.72585","4":"-53.58035","5":"2023-02-05 18:00:13","6":"Btau","7":"4.491674","8":"4.713334","9":"0","10":"0.9929086","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="overlap-utilizando-fase-lunar" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Overlap utilizando fase lunar<a href="fase-lunar.html#overlap-utilizando-fase-lunar" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para realizar ajustar funciones de densidad kernel no paramétricas utilizando el paquete de R overlap se necesitan las fases lunares, no la fracción iluminada de la luna. Para esto se utilizan solo los registros nocturnos.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="fase-lunar.html#cb31-1" tabindex="-1"></a>data_nocturnal <span class="ot">&lt;-</span> data_moon_illumination <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="fase-lunar.html#cb31-2" tabindex="-1"></a>  <span class="fu">filter</span>(nocturnal <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Obtengo las fases lunares para estos registros.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="fase-lunar.html#cb32-1" tabindex="-1"></a>data_nocturnal <span class="ot">&lt;-</span> data_nocturnal <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="fase-lunar.html#cb32-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">moon_phase =</span> <span class="fu">getMoonIllumination</span>(<span class="at">date =</span> <span class="fu">as_date</span>(datetime))<span class="sc">$</span>phase)</span></code></pre></div>
<p>Se ajustan los valores de las fases lunares a radianes.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="fase-lunar.html#cb33-1" tabindex="-1"></a>data_nocturnal <span class="ot">&lt;-</span> data_nocturnal <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="fase-lunar.html#cb33-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">moon_phase =</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> moon_phase)</span></code></pre></div>
<p>Utilizo las especies de cérvidos <em>Axis axis</em> y <em>Subulo gouazoubira</em> para realizar el overlap. Primero me quedo solo con los datos de la especie y luego lo realizo.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="fase-lunar.html#cb34-1" tabindex="-1"></a><span class="co"># Datos de Aaxi</span></span>
<span id="cb34-2"><a href="fase-lunar.html#cb34-2" tabindex="-1"></a>tmp1 <span class="ot">&lt;-</span> data_nocturnal <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="fase-lunar.html#cb34-3" tabindex="-1"></a>  <span class="fu">filter</span>(sp <span class="sc">==</span> <span class="st">&quot;Aaxi&quot;</span>)</span>
<span id="cb34-4"><a href="fase-lunar.html#cb34-4" tabindex="-1"></a></span>
<span id="cb34-5"><a href="fase-lunar.html#cb34-5" tabindex="-1"></a><span class="co"># Datos de Subulo [Mazama] gouazoubira</span></span>
<span id="cb34-6"><a href="fase-lunar.html#cb34-6" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> data_nocturnal <span class="sc">%&gt;%</span> </span>
<span id="cb34-7"><a href="fase-lunar.html#cb34-7" tabindex="-1"></a>  <span class="fu">filter</span>(sp <span class="sc">==</span> <span class="st">&quot;Mgou&quot;</span>)</span>
<span id="cb34-8"><a href="fase-lunar.html#cb34-8" tabindex="-1"></a></span>
<span id="cb34-9"><a href="fase-lunar.html#cb34-9" tabindex="-1"></a><span class="fu">overlapPlot</span>(tmp1<span class="sc">$</span>moon_phase,</span>
<span id="cb34-10"><a href="fase-lunar.html#cb34-10" tabindex="-1"></a>            tmp2<span class="sc">$</span>moon_phase,</span>
<span id="cb34-11"><a href="fase-lunar.html#cb34-11" tabindex="-1"></a>            <span class="at">xscale=</span><span class="cn">NA</span>,</span>
<span id="cb34-12"><a href="fase-lunar.html#cb34-12" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb34-13"><a href="fase-lunar.html#cb34-13" tabindex="-1"></a>            <span class="at">linecol =</span> <span class="fu">c</span>(<span class="st">&quot;#8ac926&quot;</span>, <span class="st">&quot;#1982c4&quot;</span>),</span>
<span id="cb34-14"><a href="fase-lunar.html#cb34-14" tabindex="-1"></a>            <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb34-15"><a href="fase-lunar.html#cb34-15" tabindex="-1"></a>            <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Overlap&quot;</span>, tmp1<span class="sc">$</span>sp[<span class="dv">1</span>], <span class="st">&quot;y&quot;</span>, tmp2<span class="sc">$</span>sp[<span class="dv">1</span>]),</span>
<span id="cb34-16"><a href="fase-lunar.html#cb34-16" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">&quot;Moon phase&quot;</span>,</span>
<span id="cb34-17"><a href="fase-lunar.html#cb34-17" tabindex="-1"></a>            <span class="at">extend =</span> <span class="st">&#39;white&#39;</span>)</span>
<span id="cb34-18"><a href="fase-lunar.html#cb34-18" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> pi, pi <span class="sc">/</span><span class="dv">2</span>), <span class="at">text =</span> <span class="fu">c</span>(<span class="st">&quot;🌑</span><span class="sc">\n</span><span class="st">New Moon&quot;</span>, <span class="st">&quot;🌓</span><span class="sc">\n</span><span class="st">First Quarter&quot;</span>, <span class="st">&quot;🌕</span><span class="sc">\n</span><span class="st">Full Moon&quot;</span>, <span class="st">&quot;🌗</span><span class="sc">\n</span><span class="st">Last Quarter&quot;</span>, <span class="st">&quot;🌑</span><span class="sc">\n</span><span class="st">New Moon&quot;</span>), <span class="at">padj =</span> <span class="dv">1</span>)</span>
<span id="cb34-19"><a href="fase-lunar.html#cb34-19" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb34-20"><a href="fase-lunar.html#cb34-20" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="fu">c</span>(<span class="st">&quot;Aaxi&quot;</span>, <span class="st">&quot;Sgou&quot;</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#8ac926&quot;</span>, <span class="st">&quot;#1982c4&quot;</span>), <span class="at">bg=</span><span class="st">&#39;white&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<p>Y se obtienen los valores de estimación de overlap, demostrando una alta superposición en las curvas de densidad y por lo tanto, una mayor similitud en su actividad.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="fase-lunar.html#cb35-1" tabindex="-1"></a><span class="fu">overlapEst</span>(tmp1<span class="sc">$</span>moon_phase,tmp2<span class="sc">$</span>moon_phase)</span></code></pre></div>
<pre><code>##     Dhat1     Dhat4     Dhat5 
## 0.8607370 0.8636668 0.8717382</code></pre>
</div>
<div id="kernels-de-superposición-para-pares-de-especies" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Kernels de Superposición para Pares de Especies<a href="fase-lunar.html#kernels-de-superposición-para-pares-de-especies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A continuación, se generan gráficos de superposición de fases lunares para los registros nocturnos de todos los pares de especies de interés. En estos graficos se puede ver entre () la cantiad de registros nocturnos para cada especie.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="fase-lunar.html#cb37-1" tabindex="-1"></a>species_pairs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Ctho&quot;</span>, <span class="st">&quot;Lgym&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;Aaxi&quot;</span>, <span class="st">&quot;Mgou&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;Dnov&quot;</span>, <span class="st">&quot;Dsep&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;Lgeo&quot;</span>, <span class="st">&quot;Lwie&quot;</span>))</span>
<span id="cb37-2"><a href="fase-lunar.html#cb37-2" tabindex="-1"></a></span>
<span id="cb37-3"><a href="fase-lunar.html#cb37-3" tabindex="-1"></a><span class="co"># Bucle para generar los gráficos</span></span>
<span id="cb37-4"><a href="fase-lunar.html#cb37-4" tabindex="-1"></a><span class="cf">for</span> (pair <span class="cf">in</span> species_pairs) {</span>
<span id="cb37-5"><a href="fase-lunar.html#cb37-5" tabindex="-1"></a>  <span class="co"># Filtrar los datos para cada especie en el par</span></span>
<span id="cb37-6"><a href="fase-lunar.html#cb37-6" tabindex="-1"></a>  tmp1 <span class="ot">&lt;-</span> data_nocturnal[data_nocturnal<span class="sc">$</span>sp <span class="sc">==</span> pair[<span class="dv">1</span>], ]</span>
<span id="cb37-7"><a href="fase-lunar.html#cb37-7" tabindex="-1"></a>  tmp2 <span class="ot">&lt;-</span> data_nocturnal[data_nocturnal<span class="sc">$</span>sp <span class="sc">==</span> pair[<span class="dv">2</span>], ]</span>
<span id="cb37-8"><a href="fase-lunar.html#cb37-8" tabindex="-1"></a>  </span>
<span id="cb37-9"><a href="fase-lunar.html#cb37-9" tabindex="-1"></a>  <span class="co"># Contar el número de registros de cada especie</span></span>
<span id="cb37-10"><a href="fase-lunar.html#cb37-10" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(tmp1)</span>
<span id="cb37-11"><a href="fase-lunar.html#cb37-11" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(tmp2)</span>
<span id="cb37-12"><a href="fase-lunar.html#cb37-12" tabindex="-1"></a>  </span>
<span id="cb37-13"><a href="fase-lunar.html#cb37-13" tabindex="-1"></a>  <span class="co"># Crear el gráfico de superposición</span></span>
<span id="cb37-14"><a href="fase-lunar.html#cb37-14" tabindex="-1"></a>  <span class="fu">overlapPlot</span>(tmp1<span class="sc">$</span>moon_phase,</span>
<span id="cb37-15"><a href="fase-lunar.html#cb37-15" tabindex="-1"></a>              tmp2<span class="sc">$</span>moon_phase,</span>
<span id="cb37-16"><a href="fase-lunar.html#cb37-16" tabindex="-1"></a>              <span class="at">xscale=</span><span class="cn">NA</span>,</span>
<span id="cb37-17"><a href="fase-lunar.html#cb37-17" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb37-18"><a href="fase-lunar.html#cb37-18" tabindex="-1"></a>              <span class="at">linecol =</span> <span class="fu">c</span>(<span class="st">&quot;#8ac926&quot;</span>, <span class="st">&quot;#1982c4&quot;</span>),</span>
<span id="cb37-19"><a href="fase-lunar.html#cb37-19" tabindex="-1"></a>              <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb37-20"><a href="fase-lunar.html#cb37-20" tabindex="-1"></a>              <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Overlap &quot;</span>, pair[<span class="dv">1</span>], <span class="st">&quot; (&quot;</span>, n1, <span class="st">&quot;)&quot;</span>, <span class="st">&quot; y &quot;</span>, pair[<span class="dv">2</span>], <span class="st">&quot; (&quot;</span>, n2, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb37-21"><a href="fase-lunar.html#cb37-21" tabindex="-1"></a>              <span class="at">xlab =</span> <span class="st">&quot;Moon phase&quot;</span>,</span>
<span id="cb37-22"><a href="fase-lunar.html#cb37-22" tabindex="-1"></a>              <span class="at">extend =</span> <span class="st">&#39;white&#39;</span>)</span>
<span id="cb37-23"><a href="fase-lunar.html#cb37-23" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="fu">c</span>(pair[<span class="dv">1</span>], pair[<span class="dv">2</span>]), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#8ac926&quot;</span>, <span class="st">&quot;#1982c4&quot;</span>), <span class="at">bg=</span><span class="st">&#39;white&#39;</span>)</span>
<span id="cb37-24"><a href="fase-lunar.html#cb37-24" tabindex="-1"></a>  <span class="co"># Personalizar los ejes y agregar líneas verticales</span></span>
<span id="cb37-25"><a href="fase-lunar.html#cb37-25" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> pi, pi <span class="sc">/</span> <span class="dv">2</span>), <span class="at">text =</span> <span class="fu">c</span>(<span class="st">&quot;🌑</span><span class="sc">\n</span><span class="st">New Moon&quot;</span>, <span class="st">&quot;🌓</span><span class="sc">\n</span><span class="st">First Quarter&quot;</span>, <span class="st">&quot;🌕</span><span class="sc">\n</span><span class="st">Full Moon&quot;</span>, <span class="st">&quot;🌗</span><span class="sc">\n</span><span class="st">Last Quarter&quot;</span>, <span class="st">&quot;🌑</span><span class="sc">\n</span><span class="st">New Moon&quot;</span>), <span class="at">padj =</span> <span class="dv">1</span>)</span>
<span id="cb37-26"><a href="fase-lunar.html#cb37-26" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> pi), <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb37-27"><a href="fase-lunar.html#cb37-27" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-88-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-88-2.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-88-3.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-88-4.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="categorías-de-nicho-temporal.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tasa-de-registro-vacunos-y-perros-domésticos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/chapters/fase-lunar.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
